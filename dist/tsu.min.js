/*!
 * Copyright 2016, nju33
 * Released under the MIT License
 * https://github.com/totora0155/tsu.js
 */
!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):global.Tsu=factory()}(this,function(){"use strict";function Tsu(label,opts){if(this.label=label,this.opts={color:"#fff",size:3},null!=opts.color&&(this.opts.color=opts.color),null!=opts.size){if("number"!=typeof opts.size)throw Error("Please `size` specify a number value");this.opts.size=opts.size}}function init(){injectStyle();var box=document.createElement("ul");return box.className="tsu__box",document.body.appendChild(box),box}function create(label,msg,opts){var log=document.createElement("li");return log.className="tsu__log tsu__"+label,log.innerHTML='<div class="tsu__inner"><span class="tsu__label">'+label+'</span><span class="tsu__message">'+msg+"</span></div>",log.children[0].style.background=opts.color,log}function insert(el){box.insertBefore(el,box.children[0]),el.setAttribute("data-height",el.children[0].clientHeight),state.unshift(el)}function show(el){var height=el.getAttribute("data-height");el.style.height=height+"px",el.style.opacity=1}function remove(el,type){switch(null==type&&(type="fall"),type){case"fall":fall(el);break;case"hide":hide(el)}Tsu.config.clickEvent&&log.removeEventListener("click",handleClick,!1)}function handleClick(e){remove(e.currentTarget,"hide")}function fall(el){var height=el.getAttribute("data-height");el.style.opacity=0,el.children[0].style.top=height+"px",setTimeout(function(){el.parentNode&&el.parentNode.removeChild(el)},125)}function hide(el){el.style.opacity=0,el.style.height=0}function injectStyle(){var style=document.createElement("style"),easeOutBack="cubic-bezier(0.175, 0.885, 0.32, 1.275)",css=".tsu__box {position: fixed;right: 50%;top: 1em;min-width: "+Tsu.config.width+";-ms-transform: translateX(50%);-webkit-transform: translateX(50%);transform: translateX(50%);list-style: none;}.tsu__log {overflow:hidden;margin: .5em;-webkit-transition:height .2s "+easeOutBack+",opacity .125s ease-out;transition:height .2s "+easeOutBack+",opacity .125s ease-out;height: 0;opacity: 0;-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}.tsu__inner {position: relative;padding: .5em;-webkit-transition: top .125s ease-out;transition: top .125s ease-out;top: 0;}.tsu__label {padding: .3em .5em;margin-right: .5em;border-radius: 7px;background: hsla(0, 100%, 100%, .3);}";style.innerText=css,document.head.insertBefore(style,document.head.children[0])}var box=null,state=[];return Tsu.config={width:"15em",timeout:2e3,clickEvent:!1},Tsu.prototype.add=function(msg){box||(box=init());var log=create(this.label,msg,this.opts);if(Tsu.config.clickEvent&&log.addEventListener("click",handleClick,!1),insert(log),setTimeout(show.bind(null,log),0),state.length>this.opts.size){var target=state.pop();remove(target)}if(Tsu.config.timeout)try{setTimeout(function(){remove(log,"hide")},Tsu.config.timeout)}catch(e){throw Error(e)}},Tsu});
